ğŸ“˜ å›ºå®šãƒšãƒ¼ã‚¸ï¼šergo_BLE - ZMKç’°å¢ƒæ§‹ç¯‰ã¨ãƒ“ãƒ«ãƒ‰å±¥æ­´

ğŸ§­ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: ergo_BLE

æ§‹æˆå¯¾è±¡: BLEå¯¾å¿œã®åˆ†å‰²ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼ˆå·¦å´ï¼‰

æ“ä½œå½¹: Mitsuharuï¼ˆã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰

æŒ‡æ®ãƒ»é€²è¡Œç®¡ç†: Copilotï¼ˆæ§‹æˆãƒ»æ”¯æ´ï¼‰

ğŸ› ï¸ ç’°å¢ƒæ§‹ç¯‰ï¼ˆZMK Firmwareï¼‰

ğŸ“¦ å¿…é ˆãƒ„ãƒ¼ãƒ«

Python 3.10ï¼ˆPATHè¡çªã‚„ã‚¨ã‚¤ãƒªã‚¢ã‚¹æ³¨æ„ï¼‰

Zephyr SDKï¼ˆSDKãƒ‘ã‚¹ã®é€šã—æ–¹é‡è¦ï¼‰

westï¼ˆSDKåŒæ¢±ï¼‰

ğŸ” æ§‹ç¯‰ã‚¹ãƒ†ãƒƒãƒ—

# weståˆæœŸåŒ–
py -3.10 -m west init -l .

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ›´æ–°
py -3.10 -m west update

# Zephyrç’°å¢ƒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
py -3.10 -m west zephyr-export

# ZIPå±•é–‹ã®å ´åˆã¯ .gitignore ã®é€€é¿ãŒå¿…è¦ï¼ˆMove-Item ã§å›é¿ï¼‰

# modules/zmk ã« Git clone ã§ç½®ãç›´ã—ã‚‚æ¤œè¨ï¼ˆwestèªè­˜å¯¾ç­–ï¼‰

ã‚·ãƒ¼ãƒ«ãƒ‰æ§‹æˆï¼šergo_ble_left

ğŸ“ config/boards/shields/ergo_ble_left ã«ä»¥ä¸‹ã®æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ï¼š

ãƒ•ã‚¡ã‚¤ãƒ«å

ç”¨é€”

shield.dts

splitã‚¿ã‚¤ãƒ—ã¨bindingså®šç¾©ï¼ˆtype = leftï¼‰

ergo_ble.overlay

devicetreeã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å®šç¾©

ergo_ble.conf

BLEãƒ»é›»æºè¨­å®šï¼ˆç¾åœ¨ã¯ç©º orå¾Œæ—¥æ‹¡å¼µï¼‰

ergo_ble_left.keymap

å·¦å´ã®ã‚­ãƒ¼ãƒãƒƒãƒ—ï¼ˆ3åˆ—Ã—6ã‚­ãƒ¼ï¼‰

Kconfig

ã‚«ã‚¹ã‚¿ãƒ è¨­å®šç”¨

ğŸ“ ä»»æ„ãƒ•ã‚©ãƒ«ãƒ€ï¼škeymap_assets

ãƒ•ã‚©ãƒ«ãƒ€å

ç”¨é€”

keymap_assets

ç·¨é›†å‰ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ã®ç´ æç½®ãå ´

ğŸ”¨ ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰ï¼ˆå®‰å®šåŒ–æ¸ˆï¼‰

py -3.10 -m west build -s app -b nice_nano_v2 -- -DSHIELD=ergo_ble_left

# ç’°å¢ƒå¤‰æ•°ã®ç™»éŒ²
$env:ZEPHYR_BASE="C:\\path\\to\\zephyr"

# ZEPHYR_BASE ã¯ Zephyr ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ«ãƒ¼ãƒˆ
# ZEPHYR_SDK_INSTALL_DIR ã¯ SDK ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆ

# ãƒ“ãƒ«ãƒ‰å‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‰Šé™¤
Remove-Item build -Recurse -Force
Remove-Item .west -Recurse -Force
Remove-Item .modules -Recurse -Force

# ãƒ“ãƒ«ãƒ‰ç›´å‰ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
Get-ChildItem -Path config/boards/shields/ergo_ble_left
echo $env:ZEPHYR_BASE
where python
py -3.10 --version

ğŸ› ï¸ westå†æ§‹æˆæ‰‹é †

manifest initå¤±æ•—æ™‚

mkdir C:\\Users\\mitsuharu\\github\\zmk-config
cd C:\\Users\\mitsuharu\\github\\zmk-config
py -3.10 -m west init zmk-config --manifest-url https://github.com/zmkfirmware/zmk --manifest-rev main
cd zmk-config
py -3.10 -m west update
py -3.10 -m west zephyr-export

ZEPHYR_BASEç’°å¢ƒå¤‰æ•°ã®å½±éŸ¿

Remove-Item Env:\\ZEPHYR_BASE
py -3.10 -m west init -m https://github.com/zmkfirmware/zmk-manifest --mr main .
py -3.10 -m west update
py -3.10 -m west zephyr-export

å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¿½åŠ 

Remove-Item .west -Recurse -Force
py -3.10 -m west init -m https://github.com/zmkfirmware/zmk-manifest --mr main .

ğŸ§© 2025/07/18ã®ä¸å…·åˆè¨˜éŒ²ã¨å›é¿ç­–

west build æœªå®šç¾©ã®åŸå› ã¨å¯¾ç­–

west update ã¯æˆåŠŸã—ã¦ã‚‚ã€west build å®Ÿè¡Œæ™‚ã« "unknown command" ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€‚

åŸå› : modules/zmk/scripts/west_commands ãŒ west ã«èªè­˜ã•ã‚Œã¦ã„ãªã„ã€‚

.west ã®èª¤ç”Ÿæˆã¨ workspaceãƒˆãƒƒãƒ—ã®å›ºå®šæ³•

zmk-keyboard ã« .git ã‚’é…ç½®ã—ã¦ workspaceãƒˆãƒƒãƒ—ã‚’æ˜ç¤ºã™ã‚‹ã€‚

è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« .git ã‚„ .west ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

west init -l . ã‚’ zmk-keyboard ã§å®Ÿè¡Œã—ã€.west/config ãŒãã®ä¸­ã«ç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

ZEPHYR_BASE ã«ã‚ˆã‚‹åˆæœŸåŒ–å¤±æ•—ã®å›é¿ç­–

Remove-Item Env:\ZEPHYR_BASE ã‚’å®Ÿè¡Œã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’è§£é™¤ã€‚

ãã®å¾Œ west init ã‚’å†å®Ÿè¡Œã€‚

å†ç™ºé˜²æ­¢ç­–

ç’°å¢ƒå¤‰æ•°ã®ç¢ºèªã¨ç®¡ç†: ZEPHYR_BASE ã‚„ ZEPHYR_SDK_INSTALL_DIR ã®è¨­å®šã‚’å®šæœŸçš„ã«ç¢ºèªã€‚

.west ãƒ•ã‚©ãƒ«ãƒ€ã®ç®¡ç†: ä¸è¦ãª .west ãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã‚’ç¢ºèªã€‚

manifestè¨­å®š: west init å®Ÿè¡Œæ™‚ã« -m ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€æ˜ç¤ºçš„ã« manifest ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã€‚

west commands ã®ç¢ºèª: modules/zmk/scripts/west_commands ãŒæ­£ã—ãé…ç½®ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

å®šæœŸçš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: zmk-keyboard ãƒ•ã‚©ãƒ«ãƒ€å…¨ä½“ã‚’å®šæœŸçš„ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€‚

ğŸ“˜ è¿½åŠ çŸ¥è¦‹ï¼šwest workspaceãƒˆãƒƒãƒ—ã®å¼·åˆ¶å›ºå®šæ³•ï¼ˆmanifeståˆ†é›¢ï¼‰

west ã¯ .git ã‚ˆã‚Šã‚‚ manifestã®å ´æ‰€ã‚’å„ªå…ˆã—ã¦ .west ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚

manifestã‚’åˆ¥ãƒ•ã‚©ãƒ«ãƒ€ã«åˆ†é›¢ã™ã‚‹ã“ã¨ã§ workspaceãƒˆãƒƒãƒ—ã‚’æ„å›³é€šã‚Šã«å›ºå®šã§ãã‚‹ã€‚

west init -m <manifest> ã‚’ workspaceãƒˆãƒƒãƒ—ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ .west ã‚’ãã®ä¸­ã«ç”Ÿæˆã§ãã‚‹ã€‚

ğŸ§¹ ä¸è¦ãƒ‡ãƒ¼ã‚¿ã®æƒé™¤æ‰‹é †

1. ä¸è¦ãªãƒ•ã‚©ãƒ«ãƒ€ã®ç¢ºèªã¨å‰Šé™¤

# ä¸è¦ãªãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
Get-ChildItem -Path C:\\Users\\mitsuharu\\github -Directory

# å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰ï¼ˆç¢ºèªå¾Œå®Ÿè¡Œï¼‰
Remove-Item -Path C:\\Users\\mitsuharu\\github\\<ä¸è¦ãƒ•ã‚©ãƒ«ãƒ€å> -Recurse -Force

2. .west ãƒ•ã‚©ãƒ«ãƒ€ã®æ•´ç†

# å­˜åœ¨ã—ãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
if (Test-Path -Path .west) {
    Remove-Item -Path .west -Recurse -Force
}

3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢

# ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å‰Šé™¤
Remove-Item -Path build -Recurse -Force

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å‰Šé™¤
Remove-Item -Path .modules -Recurse -Force

4. CopilotãŒç”Ÿæˆã—ãŸä¸è¦ãƒ•ã‚©ãƒ«ãƒ€ã®å‰Šé™¤

# CopilotãŒç”Ÿæˆã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
Get-ChildItem -Path C:\\Users\\mitsuharu\\github -Directory | Where-Object { $_.Name -match "^(zmk-manifest|zmk-config|modules\\\\zmk|build)$" }

# å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰ï¼ˆç¢ºèªå¾Œå®Ÿè¡Œï¼‰
Remove-Item -Path C:\\Users\\mitsuharu\\github\\<å¯¾è±¡ãƒ•ã‚©ãƒ«ãƒ€å> -Recurse -Force

ã“ã®å†…å®¹ã‚’ã‚‚ã¨ã«ã€æ¬¡å›ã®æ§‹æˆä½œæ¥­ã‚’é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚
